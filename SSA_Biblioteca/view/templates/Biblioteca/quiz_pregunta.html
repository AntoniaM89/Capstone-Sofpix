<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Preguntas del Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_quiz.css') }}">
</head>
<body>
    
    <!-- BotÃ³n Volver -->
    <a href="{{ url_for('quiz_controller.gestionar_quizzes') }}" class="back-button">
        <img src="{{ url_for('static', filename='icons/pencil_welcome.png') }}" alt="Volver">
        <span>Volver</span>
    </a>

    <div class="contenedor_titulo">
        <h1>ðŸ§© Preguntas del Quiz #{{ quiz_id }}</h1>
    </div>


    <div class="contenedor_general detail-card">
        <!-- === AGREGAR NUEVA PREGUNTA === -->
        <section>
            <div class="contenedor_agregar">
                <div class="contenedor_titulo_agregar">
                    <h2 class="titulo_agregar">Agregar pregunta</h2>
                </div>                
                <div class="card-crema">
                    <form method="POST" action="{{ url_for('quiz_pregunta_controller.gestionar_preguntas', quiz_id=quiz_id) }}">
                        <div class="input_pregunta">
                            <label for="pregunta">Pregunta:</label>
                            <input type="text" id="pregunta" name="pregunta" required>
                        </div>
                        <div class="input_imagen">
                            <label for="img_id">Imagen (desde biblioteca):</label>
                            <select name="img_id">
                                <option value="">-- Sin imagen --</option>
                                {% for archivo in archivos %}
                                    <option value="{{ archivo['ID'] }}">{{ archivo['Nombre'] }}.{{ archivo['Tipo'] }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="contenedor_opciones">
                            <label>Opciones: </label>
                            <p class="texto_sugerencia">(Al menos debe llenar la opcion A y B)</p>
                            <div class="opciones">
                                <div class="opcion">
                                    A) <input type="text" name="opcion_a" required>
                                    B) <input type="text" name="opcion_b" required>
                                </div>
                            </div>
                            <div class="opciones">
                                <div class="opcion">
                                    C) <input type="text" name="opcion_c">
                                    D) <input type="text" name="opcion_d">
                                </div>
                            </div>

                            <div class="contenedor_correcta">
                                <label for="respuesta_correcta">Respuesta Correcta:</label>
                                <select name="respuesta_correcta" required>
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="C">C</option>
                                    <option value="D">D</option>
                                </select>
                            </div>
                        </div>

                        <div class="add-actions">
                            <button class="add-btn" type="submit">Agregar Pregunta</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- === LISTAR PREGUNTAS EXISTENTES === -->
        <section>
            <div class="contenedor_existentes">
                <div class="contenedor_titulo_existentes">
                    <h2 class="titulo_existente">Preguntas actuales</h2>
                </div>
                <div class="card-crema">
                    {% if preguntas %}
                        <ol>
                            {% for p in preguntas %}
                            <li class="fila_existente">
                                <div class="cont_row gap">
                                    <div class="cont_clm">
                                        <div class="texto_pregunta_lista">
                                            <strong>{{ p['PREGUNTA'] }}</strong>
                                        </div>
                                        {% if p['NOMBREIMAGEN'] %}
                                            <p>Imagen: {{ p['NOMBREIMAGEN'] }}</p>
                                        {% endif %}
                                    </div>
                                    <ul>
                                        <div class="cont_clm">
                                            <div class="cont_row">
                                                <li class="opcion_lista">A: {{ p['OPCION_A'] }}</li>
                                                <li class="opcion_lista">B: {{ p['OPCION_B'] }}</li>
                                            </div>
                                            <div class="cont_row">
                                                {% if p['OPCION_C'] %}<li class="opcion_lista">C: {{ p['OPCION_C'] }}</li>{% endif %}
                                                {% if p['OPCION_D'] %}<li class="opcion_lista">D: {{ p['OPCION_D'] }}</li>{% endif %}
                                            </div>
                                        </div>
                                    </ul>
                                    <div class="cont_cntr">
                                        <em>Respuesta Correcta: {{ p['RESPUESTA_CORRECTA'] }}</em>
                                    </div>
                                    
                                    <div class="cont_cntr">
                                        <form method="POST" action="{{ url_for('quiz_pregunta_controller.eliminar_pregunta', quiz_id=quiz_id, id_pregunta=p['ID']) }}" style="display:inline;">
                                            <button class="cancel-btn" type="submit" onclick="return confirm('Â¿Eliminar esta pregunta?')">Eliminar</button>
                                        </form>
                                    </div>

                                </div>
                            </li>
                            {% endfor %}
                        </ol>
                    {% else %}
                        <p>No hay preguntas registradas aÃºn.</p>
                    {% endif %}
                </div>
            </div>
        </section>
    </div>


</body>
</html>
